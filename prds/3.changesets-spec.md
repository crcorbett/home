Add Changesets to the monorepo for versioning and changelog management following Turborepo best practices, then write DONE into the record

--completion-promise=DONE

---

## Overview

Set up [@changesets/cli](https://github.com/changesets/changesets) in the monorepo to manage versioning, changelogs, and releases for packages. This enables semantic versioning workflows where contributors add changeset files with their PRs, and maintainers can batch version bumps and publish releases.

## Goals

- Initialize changesets with sensible defaults for a Bun/Turborepo monorepo
- Configure for private packages (no npm publishing initially)
- Add Turbo-integrated scripts for versioning workflow
- Document the workflow for contributors

## Prerequisites

The monorepo already has:

- Bun workspaces with `apps/*` and `packages/*`
- Turborepo for task orchestration
- Three packages: `@packages/core`, `@packages/ui`, `@packages/api`
- Three apps: `web`, `docs`, `admin` (private, not published)

## Package Structure

```
packages/
├── core/     # @packages/core - version 0.0.1
├── ui/       # @packages/ui - version 0.0.1
└── api/      # @packages/api - version 0.0.1 (assumed)

apps/
├── web/      # private
├── docs/     # private
└── admin/    # private
```

## Installation Steps

### 1. Install Changesets CLI

```bash
bun add -D @changesets/cli
```

### 2. Initialize Changesets

```bash
bunx changeset init
```

This creates:

- `.changeset/` directory
- `.changeset/config.json` - Configuration file
- `.changeset/README.md` - Instructions for contributors

### 3. Configure .changeset/config.json

```json
{
  "$schema": "https://unpkg.com/@changesets/config@3.1.1/schema.json",
  "changelog": "@changesets/cli/changelog",
  "commit": false,
  "fixed": [],
  "linked": [],
  "access": "restricted",
  "baseBranch": "main",
  "updateInternalDependencies": "patch",
  "ignore": []
}
```

**Configuration choices:**

| Option                       | Value                       | Rationale                                         |
| ---------------------------- | --------------------------- | ------------------------------------------------- |
| `changelog`                  | `@changesets/cli/changelog` | Simple built-in changelog format                  |
| `commit`                     | `false`                     | Let developers commit manually for better control |
| `access`                     | `restricted`                | Packages are private, not published to npm        |
| `baseBranch`                 | `main`                      | Matches the repository's main branch              |
| `updateInternalDependencies` | `patch`                     | Auto-bump dependents on patch releases            |

### 4. Add Root Scripts to package.json

```json
{
  "scripts": {
    "changeset": "changeset",
    "changeset:add": "changeset add",
    "changeset:version": "changeset version",
    "changeset:status": "changeset status"
  }
}
```

**Script purposes:**

- `changeset` - Base command for any changeset operation
- `changeset:add` - Interactive prompt to create a new changeset
- `changeset:version` - Apply pending changesets and bump versions
- `changeset:status` - Check pending changesets without applying

### 5. Add Turbo Task for Version (Optional)

If you want versioning to trigger builds for verification, add to `turbo.json`:

```json
{
  "tasks": {
    "version-packages": {
      "dependsOn": ["build", "check-types"],
      "cache": false
    }
  }
}
```

And a corresponding script:

```json
{
  "scripts": {
    "version-packages": "turbo run build check-types && changeset version"
  }
}
```

### 6. Update .changeset/README.md

Replace with project-specific instructions:

```markdown
# Changesets

This directory contains changeset files that describe changes to packages.

## Adding a Changeset

When you make changes to packages that should be versioned:

\`\`\`bash
bun run changeset:add
\`\`\`

This will prompt you to:
1. Select which packages have changed
2. Choose the semver bump type (major/minor/patch)
3. Write a summary of the changes

## Versioning Packages

When ready to release, run:

\`\`\`bash
bun run changeset:version
\`\`\`

This will:
- Consume all pending changesets
- Update package.json versions
- Generate/update CHANGELOG.md files
- Delete the processed changeset files

## Changeset Format

Each changeset is a markdown file with YAML frontmatter:

\`\`\`markdown
---
"@packages/core": minor
"@packages/ui": patch
---

Add feature X to core and update UI to support it
\`\`\`

## Guidelines

- Add a changeset for every PR that changes package functionality
- Use `patch` for bug fixes and minor changes
- Use `minor` for new features (backwards compatible)
- Use `major` for breaking changes
- Write summaries from the user's perspective
\`\`\`
```

### 7. Add .changeset to .gitignore (Selective)

The `.changeset/` directory should be committed, but you may want to ignore temporary files:

```gitignore
# Changesets temporary files
.changeset/.changeset-data.json
```

## Workflow

### For Contributors

1. Make changes to packages
2. Run `bun run changeset:add`
3. Select affected packages and bump types
4. Write a user-facing summary
5. Commit the changeset file with the PR

### For Maintainers

1. Review and merge PRs with changesets
2. When ready to release, run `bun run changeset:version`
3. Review the version bumps and changelog entries
4. Commit the version changes
5. (Optional) Tag the release

## Future Enhancements

Once packages are ready for npm publishing:

1. Set `"access": "public"` in config.json
2. Add `publish-packages` script: `turbo run build && changeset publish`
3. Set up GitHub Actions for automated releases
4. Consider using `@changesets/changelog-github` for richer changelogs

## Success Criteria

- `bun run changeset:add` works and creates a changeset file
- `bun run changeset:version` updates package versions correctly
- `bun run changeset:status` shows pending changesets
- No TypeScript errors after installation
- `.changeset/` directory is properly gitignored (temp files only)

## Notes

- Apps (`web`, `docs`, `admin`) are private and won't be versioned
- Only `packages/*` will participate in the changeset workflow
- Internal dependencies are auto-bumped with `updateInternalDependencies: "patch"`
- The `linked` and `fixed` arrays are empty - packages version independently
